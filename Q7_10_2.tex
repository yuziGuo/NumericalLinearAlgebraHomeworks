\section*{Question 7}
\textcolor{blue}{[QR Factorization with MATLAB Householder]} 

(a) Write a Matlab function $[W,R] = house(A)$ that computes an implicit representation of a full QR factorization 
$A = QR$ of an $m \times n$ matrix $A$ with $m > n$ using Householder reflections. 
The output variables are a lower-triangular matrix $W \in \mathbb{C}^{m \times n}$ 
whose columns are the vectors $v_k$ defining the successive Householder reflections, 
and a triangular matrix $R \in \mathbb{C}^{n \times n}$.

(b) Write a Matlab function $Q = formQ(W)$ that takes 
the matrix $W$ produced by $house$ as input 
and generates a corresponding $m \times m$ orthogonal matrix $Q$.

\subsection*{test code}

% \lstinputlisting[
%     style       =   Matlab,
%     caption     =   {\bf ff.m},
%     label       =   {ff.m}
% ]{./ff.m}
\begin{lstlisting}[language=matlab]
    m = 8
    n = 4
    x = (-m/2:m/2-1)'/(m/2)
    A = [x.^0  x.^1  x.^2 x.^3]
    % W = house(A)

    % function [W] = house(A)
    % [m, n] = size(A)
    W = zeros(m, n)
    e1 = eye(m, 1)
    for k=1:n
        x = A(k:m, k)
        e1_sub = e1(1:m-k+1)
        vk = sign(x(1))*norm(x,2) * e1_sub + x
        vk = vk / norm(vk,2)
        A(k:m,k:n) = A(k:m,k:n) - 2*vk*(vk'*A(k:m,k:n))  % HouseHolder mapping; 
        W(k:m,k) = vk
    end

    R=A(1:n,:)
\end{lstlisting}